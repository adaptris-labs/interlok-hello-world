plugins {
  id "com.palantir.docker" version "0.22.1"
}

ext {
  interlokParentGradle = project.hasProperty('interlokParentGradle') ? project.getProperty('interlokParentGradle') : "https://raw.githubusercontent.com/adaptris-labs/interlok-build-parent/master/build.gradle"
  interlokVerifyEnvironmentProperties = ['PORT': '8080']
  buildEnv = 'env'
}

allprojects {
  apply from: "${interlokParentGradle}"
}

dockerfileZip.enabled=false

distributions {
  main {
    contents {
      into('/') {
        from file("$projectDir/src/main/resources/docker-entrypoint-wrapper.sh")
      }
    }
  }
}

docker {
  name "adaptrislabs/interlok-hello-world"
  tags 'latest'
  pull true
  files tasks.installDist.outputs
}

docker.dependsOn installDist
